
<!doctype html><html lang="ko"><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ZEB 4등급 PV 권장용량 계산기</title>
<style>
:root{--bg:#0b0e13;--card:#121723;--muted:#9aa4b2;--text:#e7ecf3;--pri:#14b8a6;--border:#1f2633}
html,body{background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;margin:0}
.wrap{max-width:1080px;margin:32px auto;padding:0 16px}
h1{font-size:22px;margin:8px 0 16px 0}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;margin-bottom:16px}
label{font-size:12px;color:var(--muted);display:block;margin:0 0 6px 4px}
input,select{width:100%;background:#0f1420;border:1px solid var(--border);color:var(--text);padding:10px;border-radius:10px;outline:none}
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
button{background:var(--pri);color:#00110f;border:none;border-radius:10px;padding:10px 14px;cursor:pointer;font-weight:700}
.muted{color:var(--muted);font-size:12px}
.big{font-size:28px;font-weight:800}
.mono{font-family:ui-monospace,Menlo,Consolas,monospace}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid var(--border);font-size:13px}
th{color:var(--muted);text-align:left;font-weight:600}
.pill{background:#0f1420;border:1px solid var(--border);padding:4px 8px;border-radius:999px;font-size:12px;margin-left:6px}
</style>
<div class="wrap">
<h1>제로에너지 4등급(≥40%) 달성을 위한 <span class="pill">PV 권장 용량 계산</span></h1>
<div class="card">
  <div class="grid">
    <div><label>용도</label><select id="usage"></select></div>
    <div><label>지역</label><select id="region"></select></div>
    <div><label>연면적 (㎡)</label><input id="area" type="number" placeholder="예: 5000"></div>
    <div><label>EUI (kWh/㎡·년) <span class="muted">(필요시 수정)</span></label><input id="eui" type="number"></div>
    <div><label>지역별 특정발전량 (kWh/kW·년) <span class="muted">(필요시 수정)</span></label><input id="yield" type="number"></div>
    <div><label>목표 자립률(%)</label><input id="target" type="number" value="40"></div>
  </div>
  <div class="row" style="margin-top:12px">
    <button id="calc">계산하기</button>
    <div class="muted">CSV 실제 사례를 근거로, 면적이 가까운 동일 용도의 평균 자립률을 사용합니다.</div>
  </div>
</div>
<div class="card">
  <div class="row" style="justify-content:space-between">
    <div><div class="muted">권장 태양광 설비용량</div><div class="big"><span id="pvkw">-</span> kW</div></div>
    <div><div class="muted">예상 연간 발전량</div><div class="big"><span id="pvgen">-</span> kWh/년</div></div>
    <div><div class="muted">사용한 데이터 기반 자립률(베이스라인)</div><div class="big"><span id="rbase">-</span> %</div></div>
  </div>
  <div class="muted" style="margin-top:6px" id="explain"></div>
</div>
<div class="card">
  <div class="row" style="justify-content:space-between;align-items:center">
    <div style="font-weight:700">가장 근접한 실제 사례</div>
    <div class="muted">용도·면적이 가까운 순으로 최대 3건</div>
  </div>
  <table style="margin-top:8px">
    <thead><tr><th>용도</th><th>지역</th><th>연면적(㎡)</th><th>자립률(%)</th></tr></thead>
    <tbody id="examples"></tbody>
  </table>
</div>
</div>
<script>
const DATA = {"meta":{"target_autarky":40},"lists":{"usages":["공장","관광 휴게 시설","교육연구 시설","교정 및 군사 시설","노유자 시설","문화 및 집회 시설","수련 시설","업무 시설","운동 시설","운수시설","의료 시설","자원순환 관련 시설","제1종근린생활 시설"],"regions":["강원","경기","경남","경북","광주","대구","대전","부산","서울","세종","울산","인천","전남","전북","제주","충남","충북"]},"defaults":{"eui":{"업무 시설":140,"교육연구 시설":110,"의료 시설":180,"판매 시설":160,"공동주택":90},"pv_yield":{"서울":1300,"경기":1300,"인천":1300,"강원":1250,"충북":1300,"충남":1300,"전북":1350,"전남":1350,"경북":1400,"경남":1400,"부산":1400,"대구":1400,"울산":1400,"광주":1350,"대전":1300,"세종":1300,"제주":1500}},"records":[{"용도":"업무 시설","지역":"경기","연면적":11676.0,"자립률":32.31},{"용도":"업무 시설","지역":"경기","연면적":5807.0,"자립률":24.26},{"용도":"운동 시설","지역":"경기","연면적":1088.0,"자립률":24.0},{"용도":"문화 및 집회 시설","지역":"충남","연면적":9741.0,"자립률":45.34},{"용도":"교육연구 시설","지역":"경기","연면적":2975.0,"자립률":33.94},{"용도":"교육연구 시설","지역":"제주","연면적":2930.0,"자립률":37.5},{"용도":"업무 시설","지역":"경기","연면적":1829.0,"자립률":57.66},{"용도":"운동 시설","지역":"경기","연면적":2690.0,"자립률":26.03},{"용도":"교육연구 시설","지역":"인천","연면적":2032.0,"자립률":35.62},{"용도":"교육연구 시설","지역":"경기","연면적":2055.0,"자립률":21.55},{"용도":"교육연구 시설","지역":"경기","연면적":1858.0,"자립률":30.34},{"용도":"업무 시설","지역":"경남","연면적":2025.0,"자립률":34.87},{"용도":"업무 시설","지역":"경기","연면적":6848.0,"자립률":50.34},{"용도":"교육연구 시설","지역":"충북","연면적":5421.0,"자립률":21.13},{"용도":"교육연구 시설","지역":"전북","연면적":3912.0,"자립률":26.7},{"용도":"업무 시설","지역":"서울","연면적":2776.0,"자립률":20.37},{"용도":"관광 휴게 시설","지역":"대전","연면적":2375.0,"자립률":59.82},{"용도":"문화 및 집회 시설","지역":"부산","연면적":6151.0,"자립률":55.43},{"용도":"노유자 시설","지역":"충북","연면적":2874.0,"자립률":51.24},{"용도":"교육연구 시설","지역":"대전","연면적":13026.0,"자립률":26.83},{"용도":"수련 시설","지역":"충북","연면적":1687.0,"자립률":20.55},{"용도":"교육연구 시설","지역":"경북","연면적":1405.0,"자립률":24.34},{"용도":"교정 및 군사 시설","지역":"전남","연면적":2823.0,"자립률":58.01},{"용도":"교육연구 시설","지역":"대전","연면적":2141.0,"자립률":21.37},{"용도":"업무 시설","지역":"경북","연면적":5294.0,"자립률":41.28},{"용도":"교육연구 시설","지역":"강원","연면적":1433.0,"자립률":22.47},{"용도":"의료 시설","지역":"부산","연면적":9347.0,"자립률":22.13},{"용도":"교육연구 시설","지역":"경기","연면적":1466.0,"자립률":34.06},{"용도":"업무 시설","지역":"충북","연면적":1463.0,"자립률":40.64},{"용도":"업무 시설","지역":"강원","연면적":1679.0,"자립률":51.78},{"용도":"교육연구 시설","지역":"경기","연면적":4216.0,"자립률":26.55},{"용도":"공장","지역":"경북","연면적":1260.0,"자립률":36.79},{"용도":"교육연구 시설","지역":"경북","연면적":1675.0,"자립률":21.31},{"용도":"노유자 시설","지역":"세종","연면적":13507.0,"자립률":27.76},{"용도":"운동 시설","지역":"전북","연면적":2432.0,"자립률":21.08},{"용도":"교육연구 시설","지역":"경북","연면적":2554.0,"자립률":68.93},{"용도":"문화 및 집회 시설","지역":"충남","연면적":3396.0,"자립률":45.32},{"용도":"교육연구 시설","지역":"경기","연면적":2246.0,"자립률":32.8},{"용도":"교육연구 시설","지역":"전남","연면적":6540.0,"자립률":57.41},{"용도":"업무 시설","지역":"경기","연면적":10305.0,"자립률":36.93},{"용도":"문화 및 집회 시설","지역":"경북","연면적":1749.0,"자립률":88.33},{"용도":"교육연구 시설","지역":"경기","연면적":3896.0,"자립률":25.85},{"용도":"교육연구 시설","지역":"강원","연면적":4331.0,"자립률":21.62},{"용도":"교육연구 시설","지역":"경북","연면적":1639.0,"자립률":26.21},{"용도":"문화 및 집회 시설","지역":"대구","연면적":2179.0,"자립률":45.21},{"용도":"업무 시설","지역":"전북","연면적":1962.0,"자립률":40.88},{"용도":"제1종근린생활 시설","지역":"부산","연면적":3402.0,"자립률":171.7},{"용도":"교육연구 시설","지역":"경기","연면적":3252.0,"자립률":33.3},{"용도":"노유자 시설","지역":"서울","연면적":4434.0,"자립률":22.28},{"용도":"교육연구 시설","지역":"전북","연면적":6702.0,"자립률":28.24},{"용도":"교육연구 시설","지역":"인천","연면적":4534.0,"자립률":127.3},{"용도":"운동 시설","지역":"제주","연면적":6095.0,"자립률":34.86},{"용도":"교육연구 시설","지역":"대구","연면적":6735.0,"자립률":53.73},{"용도":"노유자 시설","지역":"경기","연면적":577.0,"자립률":40.14},{"용도":"노유자 시설","지역":"경기","연면적":12638.0,"자립률":41.51},{"용도":"교육연구 시설","지역":"전북","연면적":1625.0,"자립률":20.68},{"용도":"교육연구 시설","지역":"전북","연면적":4246.0,"자립률":42.95},{"용도":"교육연구 시설","지역":"경남","연면적":1896.0,"자립률":30.98},{"용도":"노유자 시설","지역":"인천","연면적":3241.0,"자립률":20.33},{"용도":"교육연구 시설","지역":"경기","연면적":14082.0,"자립률":36.34},{"용도":"교육연구 시설","지역":"경기","연면적":12932.0,"자립률":30.26},{"용도":"제1종근린생활 시설","지역":"전남","연면적":1377.0,"자립률":55.01},{"용도":"업무 시설","지역":"경기","연면적":44836.0,"자립률":20.15},{"용도":"운동 시설","지역":"경북","연면적":4816.0,"자립률":27.06},{"용도":"자원순환 관련 시설","지역":"인천","연면적":2620.0,"자립률":53.28},{"용도":"교육연구 시설","지역":"강원","연면적":6280.0,"자립률":31.25},{"용도":"업무 시설","지역":"경기","연면적":4449.0,"자립률":31.23},{"용도":"운동 시설","지역":"충북","연면적":3655.0,"자립률":32.51},{"용도":"교육연구 시설","지역":"서울","연면적":14729.0,"자립률":20.8},{"용도":"노유자 시설","지역":"대구","연면적":2094.0,"자립률":28.79},{"용도":"공장","지역":"전남","연면적":11388.0,"자립률":46.8},{"용도":"운동 시설","지역":"전남","연면적":5473.0,"자립률":25.84},{"용도":"교육연구 시설","지역":"경기","연면적":1989.0,"자립률":54.24},{"용도":"교육연구 시설","지역":"인천","연면적":2392.0,"자립률":28.02},{"용도":"업무 시설","지역":"경남","연면적":1208.0,"자립률":43.02},{"용도":"노유자 시설","지역":"경기","연면적":9118.0,"자립률":22.26},{"용도":"업무 시설","지역":"경기","연면적":41596.0,"자립률":24.24},{"용도":"수련 시설","지역":"대구","연면적":4842.0,"자립률":22.15},{"용도":"교육연구 시설","지역":"서울","연면적":997.0,"자립률":54.26},{"용도":"업무 시설","지역":"충남","연면적":3711.0,"자립률":25.8},{"용도":"교육연구 시설","지역":"경기","연면적":1838.0,"자립률":34.82},{"용도":"업무 시설","지역":"경북","연면적":1375.0,"자립률":28.37},{"용도":"교육연구 시설","지역":"경기","연면적":1344.0,"자립률":28.29},{"용도":"문화 및 집회 시설","지역":"광주","연면적":1731.0,"자립률":63.55},{"용도":"교정 및 군사 시설","지역":"경기","연면적":5944.0,"자립률":51.62},{"용도":"교육연구 시설","지역":"경기","연면적":11053.0,"자립률":32.27},{"용도":"노유자 시설","지역":"경기","연면적":577.0,"자립률":79.27},{"용도":"교육연구 시설","지역":"전북","연면적":9647.0,"자립률":35.58},{"용도":"제1종근린생활 시설","지역":"경기","연면적":1349.0,"자립률":25.27},{"용도":"노유자 시설","지역":"전남","연면적":1429.0,"자립률":23.01},{"용도":"노유자 시설","지역":"서울","연면적":149.0,"자립률":155.2},{"용도":"업무 시설","지역":"서울","연면적":1273.0,"자립률":25.39},{"용도":"업무 시설","지역":"경기","연면적":5641.0,"자립률":30.49},{"용도":"교육연구 시설","지역":"서울","연면적":7447.0,"자립률":22.85},{"용도":"교육연구 시설","지역":"서울","연면적":1863.0,"자립률":43.31},{"용도":"운동 시설","지역":"경남","연면적":2290.0,"자립률":47.8},{"용도":"운동 시설","지역":"강원","연면적":1980.0,"자립률":27.35},{"용도":"업무 시설","지역":"전남","연면적":1370.0,"자립률":65.06},{"용도":"교육연구 시설","지역":"경기","연면적":1646.0,"자립률":28.44},{"용도":"교육연구 시설","지역":"경기","연면적":1424.0,"자립률":27.37},{"용도":"업무 시설","지역":"경기","연면적":11886.0,"자립률":24.59},{"용도":"업무 시설","지역":"강원","연면적":6218.0,"자립률":81.19},{"용도":"업무 시설","지역":"대구","연면적":10421.0,"자립률":23.11},{"용도":"교육연구 시설","지역":"전남","연면적":9766.0,"자립률":20.79},{"용도":"교육연구 시설","지역":"경기","연면적":1798.0,"자립률":32.78},{"용도":"운동 시설","지역":"강원","연면적":3899.0,"자립률":34.28},{"용도":"업무 시설","지역":"인천","연면적":2978.0,"자립률":35.85},{"용도":"운동 시설","지역":"광주","연면적":3337.0,"자립률":42.45},{"용도":"교육연구 시설","지역":"강원","연면적":2270.0,"자립률":21.44},{"용도":"교육연구 시설","지역":"경기","연면적":2083.0,"자립률":24.39},{"용도":"업무 시설","지역":"대전","연면적":4590.0,"자립률":27.08},{"용도":"운동 시설","지역":"경북","연면적":3114.0,"자립률":21.6},{"용도":"교육연구 시설","지역":"충남","연면적":4826.0,"자립률":37.56},{"용도":"관광 휴게 시설","지역":"강원","연면적":1410.0,"자립률":101.6},{"용도":"교육연구 시설","지역":"경기","연면적":16033.0,"자립률":24.71},{"용도":"교육연구 시설","지역":"인천","연면적":17376.0,"자립률":23.61},{"용도":"노유자 시설","지역":"경기","연면적":1944.0,"자립률":32.52},{"용도":"교육연구 시설","지역":"충북","연면적":2570.0,"자립률":31.13},{"용도":"문화 및 집회 시설","지역":"경기","연면적":1532.0,"자립률":71.22},{"용도":"업무 시설","지역":"대구","연면적":6993.0,"자립률":30.11},{"용도":"업무 시설","지역":"경기","연면적":20877.0,"자립률":26.91},{"용도":"수련 시설","지역":"경북","연면적":2225.0,"자립률":41.01},{"용도":"운수시설","지역":"강원","연면적":1813.0,"자립률":80.0},{"용도":"노유자 시설","지역":"충남","연면적":1298.0,"자립률":21.48},{"용도":"공장","지역":"부산","연면적":9306.0,"자립률":27.62},{"용도":"업무 시설","지역":"충남","연면적":2017.0,"자립률":25.72},{"용도":"노유자 시설","지역":"충북","연면적":7447.0,"자립률":32.87},{"용도":"업무 시설","지역":"충남","연면적":1563.0,"자립률":56.63},{"용도":"교육연구 시설","지역":"경남","연면적":1601.0,"자립률":21.55},{"용도":"업무 시설","지역":"서울","연면적":1380.0,"자립률":29.86},{"용도":"업무 시설","지역":"충남","연면적":1592.0,"자립률":61.11},{"용도":"노유자 시설","지역":"경기","연면적":5559.0,"자립률":24.93},{"용도":"교육연구 시설","지역":"인천","연면적":20543.0,"자립률":26.19},{"용도":"교육연구 시설","지역":"경기","연면적":2926.0,"자립률":26.89},{"용도":"운동 시설","지역":"강원","연면적":2723.0,"자립률":55.39},{"용도":"업무 시설","지역":"전북","연면적":2053.0,"자립률":28.03},{"용도":"운동 시설","지역":"광주","연면적":1984.0,"자립률":21.03},{"용도":"교육연구 시설","지역":"전북","연면적":1100.0,"자립률":33.28},{"용도":"문화 및 집회 시설","지역":"경남","연면적":9625.0,"자립률":24.4},{"용도":"업무 시설","지역":"광주","연면적":2252.0,"자립률":21.61},{"용도":"운동 시설","지역":"울산","연면적":15752.0,"자립률":26.32},{"용도":"업무 시설","지역":"경기","연면적":3527.0,"자립률":30.07},{"용도":"노유자 시설","지역":"충남","연면적":6891.0,"자립률":26.13},{"용도":"교육연구 시설","지역":"경기","연면적":1760.0,"자립률":26.13},{"용도":"교육연구 시설","지역":"충북","연면적":3065.0,"자립률":46.76},{"용도":"업무 시설","지역":"강원","연면적":1413.0,"자립률":32.97},{"용도":"교육연구 시설","지역":"부산","연면적":4062.0,"자립률":21.52},{"용도":"교육연구 시설","지역":"인천","연면적":3264.0,"자립률":32.17},{"용도":"제1종근린생활 시설","지역":"인천","연면적":5924.0,"자립률":46.73},{"용도":"문화 및 집회 시설","지역":"전북","연면적":2338.0,"자립률":54.97},{"용도":"교육연구 시설","지역":"충북","연면적":11622.0,"자립률":29.21}]};
function median(a){const b=[...a].sort((x,y)=>x-y);const m=Math.floor(b.length/2);return b.length%2?b[m]:(b[m-1]+b[m])/2}
function init(){
  const uSel=document.getElementById('usage'), rSel=document.getElementById('region');
  uSel.innerHTML = DATA.lists.usages.map(v=>`<option value="${v}">${v}</option>`).join("");
  rSel.innerHTML = DATA.lists.regions.map(v=>`<option value="${v}">${v}</option>`).join("");
  uSel.addEventListener('change',()=>{
    const u=uSel.value; document.getElementById('eui').value = (DATA.defaults.eui[u] ?? 120);
  });
  rSel.addEventListener('change',()=>{
    const r=rSel.value; document.getElementById('yield').value = (DATA.defaults.pv_yield[r] ?? 1300);
  });
  uSel.dispatchEvent(new Event('change'));
  rSel.dispatchEvent(new Event('change'));
}
function nearestExamples(usage, area, region, k=3){
  let pool = DATA.records.filter(r=>r["용도"]===usage && r["지역"]===region);
  if (pool.length<k) pool = DATA.records.filter(r=>r["용도"]===usage);
  pool.forEach(r=> r._d = Math.abs((+r["연면적"]||0) - (+area||0)));
  pool.sort((a,b)=> a._d - b._d);
  return pool.slice(0,k);
}
function baselineAutarky(usage, area, region){
  const ex = nearestExamples(usage, area, region, 10);
  if(!ex.length) return null;
  const vals = ex.map(r=> +r["자립률"]).filter(v=>!isNaN(v));
  if(!vals.length) return null;
  const avg = vals.reduce((s,v)=>s+v,0)/vals.length;
  return (avg + median(vals))/2;
}
function fmt(n,d=0){if(n==null||isNaN(n)) return "-"; return Number(n).toLocaleString(undefined,{maximumFractionDigits:d,minimumFractionDigits:d});}
function calc(){
  const usage=document.getElementById('usage').value;
  const region=document.getElementById('region').value;
  const area=parseFloat(document.getElementById('area').value);
  const eui=parseFloat(document.getElementById('eui').value);
  const y=parseFloat(document.getElementById('yield').value);
  const target=parseFloat(document.getElementById('target').value)/100;
  if(!usage||!region||!area||!eui||!y||!target){alert("용도, 지역, 연면적, EUI, 특정발전량, 목표자립률을 입력해 주세요."); return;}
  const Rb = baselineAutarky(usage, area, region); const rbaseP = Rb==null ? 0 : Rb/100; const needR = Math.max(0, target - rbaseP);
  const demand = eui * area; const pv_kW = needR===0 ? 0 : (demand * needR) / y; const pv_gen = pv_kW * y;
  document.getElementById('pvkw').textContent = fmt(pv_kW,1);
  document.getElementById('pvgen').textContent = fmt(pv_gen,0);
  document.getElementById('rbase').textContent = fmt(Rb,1);
  const ex = nearestExamples(usage, area, region, 3);
  document.getElementById('examples').innerHTML = ex.map(r=>`<tr><td>${r["용도"]}</td><td>${r["지역"]}</td><td class="mono">${fmt(r["연면적"],0)}</td><td class="mono">${fmt(r["자립률"],1)}</td></tr>`).join("");
  document.getElementById('explain').textContent = `부족 자립률: ${(needR*100).toFixed(1)}%, 연간수요: ${fmt(demand,0)} kWh, 특정발전량: ${fmt(y,0)} kWh/kW·년`;
}
document.getElementById('calc').addEventListener('click', calc); init();
</script>
</html>
